======= user ========
1. создать пользователя test
2. добавить пользователя test в группу sudo
3. авторизация по ssh
========= nginx =========
4. установка
5. создание дирекtestdomain.rutestdomain.ru;ории для сайта
6. touch /etc/nginx/sites-available/testdomain.ru.conf
7. создаем шаблон testdomain.ru.conf.j2
8. /etc/nginx/sites-available/sampledomain.ru.conf
9. server
        {
        listen 80;
          server_name testdomain.ru www.testdomain.ru;
        charset utf-8;
        root /home/webuser/www/testdomain.ru;
        index index.php index.html index.htm;

    # Static content
                        location ~* ^.+.(jpg|jpeg|gif|png|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|mp3|bmp|flv|rtf|js|swf|iso)$ {
      root /home/webuser/www/sampledomain.ru;
                   }

    location ~ \.php$
        {
          include fastcgi.conf;
          fastcgi_intercept_errors on;
          try_files $uri =404;
          fastcgi_pass 127.0.0.1:9000
    #      fastcgi_pass unix://var/run/php/sampledomain.ru.sock;
        }

    location / {
        try_files $uri $uri/ /index.php?q=$uri$args;
    }
    }

10. создание символической ссылки ln -s /etc/nginx/sites-available/sampledomain.ru.conf /etc/nginx/sites-enabled/

11. структура каталогов веб проекта
mkdir -p /home/webuser/www/sampledomain.ru
mkdir -p /home/webuser/tmp

12. создаем файл для тестирования
echo "<?php phpinfo(); ?>" > /home/webuser/www/sampledomain.ru/index.php

13. задаем валделца каталогов
chown -R webuser:webuser /home/webuser/www/
chown -R webuser:webuser /home/webuser/tmp/

14. добавляем пользователя www-data в группу test

15. restart nginx


============ php-fpm =================
1. Установка
2. создание файла пулла touch /etc/php/7.4/fpm/pool.d/testdomain.ru.conf
3. заполняем шаблон 

[testdomain.ru]
;listen = /var/run/php/sampledomain.ru.sock
listen = 127.0.0.1:9000
listen.mode = 0666
user = test
group = test
chdir = /home/test/www/testdomain.ru

php_admin_value[upload_tmp_dir] = /home/test/tmp
php_admin_value[soap.wsdl_cache_dir] = /home/test/tmp
php_admin_value[date.timezone] = Europe/Moscow
php_admin_value[upload_max_filesize] = 100M
php_admin_value[post_max_size] = 100M
php_admin_value[open_basedir] = /home/test/www/testdomain.ru/
php_admin_value[session.save_path] = /home/test/tmp
php_admin_value[disable_functions] = exec,passthru,shell_exec,system,proc_open,popen,curl_multi_exec,parse_ini_file,show_source
php_admin_value[cgi.fix_pathinfo] = 0
php_admin_value[apc.cache_by_default] = 0

pm = dynamic
pm.max_children = 7
pm.start_servers = 3
pm.min_spare_servers = 2
pm.max_spare_servers = 4

4. рестарт

